---
title: "Music Perception: Pilot Stimuli Analysis"
output: html_notebook
---

- Last checked: `r format(Sys.Date(), "%d-%b-%Y")`

# Experiment

## Stimuli
- Stimuli were selected from the previous study ([the sound of teaching music/experiment-1](https://github.com/atsukotominaga/music-teaching/tree/main/experiment-1)).
- 48 stimuli were randomly chosen from each technique (either articulation or dynamics - therefore in total 96 stimuli). The half of them were selected from the teaching condition and the other half were from the performing condition.
  + 24 for teaching-articulation performances
  + 24 for performing-articulation performances
  + 24 for teaching-dynamics performances
  + 24 for performing-dynamics performances
  
*Note: SubNr 8 was excluded due to an experimental error, SubNr 16 was excluded due to a deviated tempo (see analysis for [music-teaching: experiment-1](https://github.com/atsukotominaga/music-teaching/tree/main/experiment-1))*

## DVs
- IOIs (average tempo)
- Transition points
- CV (tempo variability)
- KOT (articulation)
- KV (dynamics)
- KV-diff (dynamics)

## Results
- 1. [Accuracy](https://github.com/atsukotominaga/perception-v1.0/blob/master/analysis/analysis.Rmd)

The accuracy results showed that it was not clear whether participants could detect teaching performances because the stimuli selection was not appropriate.

- 2. Exploratory analysis

In order to see which stimulus was recognised as teaching performances, we decided to run exploratory analysis. We plotted correlations between each DV and the percentage of judgement as "teaching" regardless of their original conditions (i.e., teaching vs. performing).

```{r setup, include = FALSE}
if (!require("data.table")) {install.packages("data.table"); require("data.table")}
if (!require("tuneR")) {install.packages("tuneR"); require("tuneR")}
if (!require("ggpubr")) {install.packages("ggpubr"); require("ggpubr")}
if (!require("performance")) {install.packages("performance"); require("performance")}
```

```{r file, include = FALSE}
# create a list of data file names
lf <- list.files("../../experiment/mid/", pattern = "mid")

# combine data
all_data <- data.table()
for (file in lf){
   current <- readMidi(paste("../../experiment/mid/", file, sep = ""))
   current$MidFile <- gsub(".mid", "", file)
   all_data <- rbind(all_data, current)
}

data <- all_data[event == "Note On" | event == "Note Off"]
data$NoteNr <- rep(1:134, nrow(data)/134)
data$channel <- NULL
data$parameterMetaSystem <- NULL
data$track <- NULL
data$type <- NULL

# labelling
colnames(data)[c(3,4)] <- c("Pitch", "Velocity") # time event also change
data$Condition <- "NA"
data$Skill <- "NA"
data[grepl("_t_", MidFile)]$Condition <- "teaching"
data[grepl("_p_", MidFile)]$Condition <- "performing"
data[grepl("a_", MidFile)]$Skill <- "articulation"
data[grepl("d_", MidFile)]$Skill <- "dynamics"

# define subcomponents
# For intervals
ls_legato <- list(c(1:7), c(17:23), c(42:48), c(58:64))
ls_staccato <- list(c(9:15), c(25:31), c(34:40), c(50:56))
ls_forte <- list(c(1:7), c(17:23), c(42:48), c(58:64))
ls_piano <- list(c(9:15), c(25:31), c(34:40), c(50:56))

# For each note (velocity only)
ls_legato_2 <- list(c(1:8), c(17:24), c(42:49), c(58:65))
ls_staccato_2 <- list(c(9:16), c(25:32), c(34:41), c(50:57))
ls_forte_2 <- list(c(1:8), c(17:24), c(42:49), c(58:65))
ls_piano_2 <- list(c(9:16), c(25:32), c(34:41), c(50:57))

# Define Skill Change (LtoS, FtoP)
change_1 <- c(8, 24, 49)
# Define Skill Change (StoL, PtoF)
change_2 <- c(16, 41, 57)
```

# IOIs
- average tempo and teaching judgement
- linear regression line (black) and 95% confidence interval (gray)

```{r ioi, include = FALSE}
data_onset <- data[event == "Note On"]
data_offset <- data[event == "Note Off"]

data_onset$IOI <- diff(c(0, data_onset$time))
dt_ioi <- data_onset[NoteNr != 1]
dt_ioi$Interval <- rep(1:66, nrow(dt_ioi)/66)

# assign Subcomponents
dt_ioi$Subcomponent <- "NA"
# Legato
for (phrase in 1:length(ls_legato)){
 for (note in 1:length(ls_legato[[phrase]])){
   dt_ioi[Skill == "articulation" & Interval == ls_legato[[phrase]][note]]$Subcomponent <- "Legato"
 }
}
# Staccato
for (phrase in 1:length(ls_staccato)){
 for (note in 1:length(ls_staccato[[phrase]])){
   dt_ioi[Skill == "articulation" & Interval == ls_staccato[[phrase]][note]]$Subcomponent <- "Staccato"
 }
}

# Forte
for (phrase in 1:length(ls_forte)){
 for (note in 1:length(ls_forte[[phrase]])){
   dt_ioi[Skill == "dynamics" & Interval == ls_forte[[phrase]][note]]$Subcomponent <- "Forte"
 }
}
# Piano
for (phrase in 1:length(ls_piano)){
 for (note in 1:length(ls_piano[[phrase]])){
   dt_ioi[Skill == "dynamics" & Interval == ls_piano[[phrase]][note]]$Subcomponent <- "Piano"
 }
}

# assign Subcomponent Change
for (number in change_1){
 dt_ioi[Skill == "articulation" & Interval == number]$Subcomponent <- "LtoS"
 dt_ioi[Skill == "dynamics" & Interval == number]$Subcomponent <- "FtoP"
}
for (number in change_2){
 dt_ioi[Skill == "articulation" & Interval == number]$Subcomponent <- "StoL"
 dt_ioi[Skill == "dynamics" & Interval == number]$Subcomponent <- "PtoF"
}
```

```{r rating, include = FALSE}
# rating as teaching
rating <- fread("../teaching_data.txt")
rating <- rating[order(MidFile)]
```

## All
```{r ioi-all, echo = FALSE}
ioi <- dt_ioi[, .(N = .N, Mean = mean(IOI), SD = sd(IOI)), by = .(MidFile)]

# sorted
ioi <- ioi[order(MidFile)]

# plot
ioi$Teaching <- rating$Mean_Percent
ioi$TeachingSD <- rating$SD_Percent

ggscatter(ioi, x = "Mean", y = "Teaching", add = "reg.line",
          add.params = list(fill = "lightgray"), conf.int = TRUE, cor.coef = TRUE,
          xlab = "IOIs (ms)", ylab = "Judged as teaching (%)") + ylim(0, 100)
```

### Model
```{r, echo = FALSE}
model <- lm(Teaching ~ Mean, data = ioi)
check_normality(model)
summary(model)
r2(model)
```

## Articulation
```{r ioi-all-art, echo = FALSE}
ioi_art <- dt_ioi[Skill == "articulation", .(N = .N, Mean = mean(IOI), SD = sd(IOI)), by = .(MidFile)]

# sorted
ioi_art <- ioi_art[order(MidFile)]

# plot
ioi_art$Teaching <- rating[Skill == "articulation"]$Mean_Percent
ioi_art$TeachingSD <- rating[Skill == "articulation"]$SD_Percent

ggscatter(ioi_art, x = "Mean", y = "Teaching", add = "reg.line",
          add.params = list(fill = "lightgray"), conf.int = TRUE, cor.coef = TRUE,
          xlab = "IOIs (ms)", ylab = "Judged as teaching (%)") + ylim(0, 100)
```

### Model
```{r, echo = FALSE}
model <- lm(Teaching ~ Mean, data = ioi_art)
check_normality(model)
summary(model)
r2(model)
```
## Dynamics
```{r ioi-all-dyn, echo = FALSE}
ioi_dyn <- dt_ioi[Skill == "dynamics", .(N = .N, Mean = mean(IOI), SD = sd(IOI)), by = .(MidFile)]

# sorted
ioi_dyn <- ioi_dyn[order(MidFile)]

# plot
ioi_dyn$Teaching <- rating[Skill == "dynamics"]$Mean_Percent
ioi_dyn$TeachingSD <- rating[Skill == "dynamics"]$SD_Percent

ggscatter(ioi_dyn, x = "Mean", y = "Teaching", add = "reg.line",
          add.params = list(fill = "lightgray"), conf.int = TRUE, cor.coef = TRUE,
          xlab = "IOIs (ms)", ylab = "Judged as teaching (%)") + ylim(0, 100)
```

### Model
```{r, echo = FALSE}
model <- lm(Teaching ~ Mean, data = ioi_dyn)
check_normality(model)
summary(model)
r2(model)
```

# Transition points
- tempo at transition points (e.g., legato to staccato / forte to piano) and teaching judgement
- linear regression line (black) and 95% confidence interval (gray)

## All
```{r ioi-tra-all, echo = FALSE}
ioi_tra <- dt_ioi[Subcomponent == "LtoS" | Subcomponent == "StoL" | Subcomponent == "FtoP" | Subcomponent == "PtoF", .(N = .N, Mean = mean(IOI), SD = sd(IOI)), by = .(MidFile)]

# sorted
ioi_tra <- ioi_tra[order(MidFile)]

# plot
ioi_tra$Teaching <- rating$Mean_Percent
ioi_tra$TeachingSD <- rating$SD_Percent

ggscatter(ioi_tra, x = "Mean", y = "Teaching", add = "reg.line",
          add.params = list(fill = "lightgray"), conf.int = TRUE, cor.coef = TRUE,
          xlab = "IOIs (ms)", ylab = "Judged as teaching (%)") + ylim(0, 100)
```

### Model
```{r, echo = FALSE}
model <- lm(Teaching ~ Mean, data = ioi_tra)
check_normality(model)
summary(model)
r2(model)
```

## Articulation
```{r ioi-tra-art, echo = FALSE}
ioi_tra_art <- dt_ioi[Subcomponent == "LtoS" | Subcomponent == "StoL", .(N = .N, Mean = mean(IOI), SD = sd(IOI)), by = .(MidFile)]

# sorted
ioi_tra_art <- ioi_tra_art[order(MidFile)]

# plot
ioi_tra_art$Teaching <- rating[Skill == "articulation"]$Mean_Percent
ioi_tra_art$TeachingSD <- rating[Skill == "articulation"]$SD_Percent

ggscatter(ioi_tra_art, x = "Mean", y = "Teaching", add = "reg.line",
          add.params = list(fill = "lightgray"), conf.int = TRUE, cor.coef = TRUE,
          xlab = "IOIs (ms)", ylab = "Judged as teaching (%)") + ylim(0, 100)
```

### Model
```{r, echo = FALSE}
model <- lm(Teaching ~ Mean, data = ioi_tra_art)
check_normality(model)
summary(model)
r2(model)
```
## Dynamics
```{r ioi-tra-dyn, echo = FALSE}
ioi_tra_dyn <- dt_ioi[Subcomponent == "FtoP" | Subcomponent == "PtoF", .(N = .N, Mean = mean(IOI), SD = sd(IOI)), by = .(MidFile)]

# sorted
ioi_tra_dyn <- ioi_tra_dyn[order(MidFile)]

# plot
ioi_tra_dyn$Teaching <- rating[Skill == "dynamics"]$Mean_Percent
ioi_tra_dyn$TeachingSD <- rating[Skill == "dynamics"]$SD_Percent

ggscatter(ioi_tra_dyn, x = "Mean", y = "Teaching", add = "reg.line",
          add.params = list(fill = "lightgray"), conf.int = TRUE, cor.coef = TRUE,
          xlab = "IOIs (ms)", ylab = "Judged as teaching (%)") + ylim(0, 100)
```

### Model
```{r, echo = FALSE}
model <- lm(Teaching ~ Mean, data = ioi_tra_dyn)
check_normality(model)
summary(model)
r2(model)
```

# CV (tempo variability)
- tempo variability and teaching judgement
- linear regression line (black) and 95% confidence interval (gray)

## All
```{r cv, echo = FALSE}
cv <- dt_ioi[, .(N = .N, CV = sd(IOI)/mean(IOI)), by = .(MidFile)]

# sorted
cv <- cv[order(MidFile)]

# plot
cv$Teaching <- rating$Mean_Percent
cv$TeachingSD <- rating$SD_Percent

ggscatter(cv, x = "CV", y = "Teaching", add = "reg.line",
          add.params = list(fill = "lightgray"), conf.int = TRUE, cor.coef = TRUE,
          xlab = "CV", ylab = "Judged as teaching (%)") + ylim(0, 100)
```

### Model
```{r, echo = FALSE}
model <- lm(Teaching ~ CV, data = cv)
check_normality(model)
summary(model)
r2(model)
```

## Articulation
```{r cv-art, echo = FALSE}
cv_art <- dt_ioi[Skill == "articulation", .(N = .N, CV = sd(IOI)/mean(IOI)), by = .(MidFile)]

# sorted
cv_art <- cv_art[order(MidFile)]

# plot
cv_art$Teaching <- rating[Skill == "articulation"]$Mean_Percent
cv_art$TeachingSD <- rating[Skill == "articulation"]$SD_Percent

ggscatter(cv_art, x = "CV", y = "Teaching", add = "reg.line",
          add.params = list(fill = "lightgray"), conf.int = TRUE, cor.coef = TRUE,
          xlab = "CV", ylab = "Judged as teaching (%)") + ylim(0, 100)
```

### Model
```{r, echo = FALSE}
model <- lm(Teaching ~ CV, data = cv_art)
check_normality(model)
summary(model)
r2(model)
```

## Dynamics
```{r cv-dyn, echo = FALSE}
cv_dyn <- dt_ioi[Skill == "dynamics", .(N = .N, CV = sd(IOI)/mean(IOI)), by = .(MidFile)]

# sorted
cv_dyn <- cv_dyn[order(MidFile)]

# plot
cv_dyn$Teaching <- rating[Skill == "dynamics"]$Mean_Percent
cv_dyn$TeachingSD <- rating[Skill == "dynamics"]$SD_Percent

ggscatter(cv_dyn, x = "CV", y = "Teaching", add = "reg.line",
          add.params = list(fill = "lightgray"), conf.int = TRUE, cor.coef = TRUE,
          xlab = "CV", ylab = "Judged as teaching (%)") + ylim(0, 100)
```

### Model
```{r, echo = FALSE}
model <- lm(Teaching ~ CV, data = cv_dyn)
check_normality(model)
summary(model)
r2(model)
```

# KOT (only articulation stimuli)
- articulation and teaching judgement
- linear regression line (black) and 95% confidence interval (gray)

```{r kot, include = FALSE}
data_onset$KOT <- NA
for (row in 1:nrow(data_onset)){
   if (row < nrow(data_onset)){
      data_onset$KOT[row+1] <- data_offset$time[row] - data_onset$time[row+1] # offset(n) - onset(n+1)
   }
}

dt_kot <- data_onset[NoteNr != 1]
dt_kot$Interval <- rep(1:66, nrow(dt_kot)/66)

# assign Subcomponents
dt_kot$Subcomponent <- "NA"
# Legato
for (phrase in 1:length(ls_legato)){
   for (note in 1:length(ls_legato[[phrase]])){
     dt_kot[Skill == "articulation" & Interval == ls_legato[[phrase]][note]]$Subcomponent <- "Legato"
   }
}
# Staccato
for (phrase in 1:length(ls_staccato)){
   for (note in 1:length(ls_staccato[[phrase]])){
     dt_kot[Skill == "articulation" & Interval == ls_staccato[[phrase]][note]]$Subcomponent <- "Staccato"
   }
}
# Forte
for (phrase in 1:length(ls_forte)){
   for (note in 1:length(ls_forte[[phrase]])){
     dt_kot[Skill == "dynamics" & Interval == ls_forte[[phrase]][note]]$Subcomponent <- "Forte"
   }
}
# Piano
for (phrase in 1:length(ls_piano)){
   for (note in 1:length(ls_piano[[phrase]])){
     dt_kot[Skill == "dynamics" & Interval == ls_piano[[phrase]][note]]$Subcomponent <- "Piano"
   }
}
# assign Subcomponent Change
for (number in change_1){
   dt_kot[Skill == "articulation" & Interval == number]$Subcomponent <- "LtoS"
   dt_kot[Skill == "dynamics" & Interval == number]$Subcomponent <- "FtoP"
}
for (number in change_2){
   dt_kot[Skill == "articulation" & Interval == number]$Subcomponent <- "StoL"
   dt_kot[Skill == "dynamics" & Interval == number]$Subcomponent <- "PtoF"
}
```

## Legato
```{r kot-legato, echo = FALSE}
kot_legato <- dt_kot[Subcomponent == "Legato", .(N = .N, Mean = mean(KOT), SD = sd(KOT)), by = .(MidFile)]

# sorted
kot_legato <- kot_legato[order(MidFile)]

# plot
kot_legato$Teaching <- rating[Skill == "articulation"]$Mean_Percent
kot_legato$TeachingSD <- rating[Skill == "articulation"]$SD_Percent

ggscatter(kot_legato, x = "Mean", y = "Teaching", add = "reg.line",
          add.params = list(fill = "lightgray"), conf.int = TRUE, cor.coef = TRUE,
          xlab = "KOT (ms)", ylab = "Judged as teaching (%)") + ylim(0, 100)
```

### Model
```{r, echo = FALSE}
model <- lm(Teaching ~ Mean, data = kot_legato)
check_normality(model)
summary(model)
r2(model)
```

## Staccato
```{r kot-staccato, echo = FALSE}
kot_staccato <- dt_kot[Subcomponent == "Staccato", .(N = .N, Mean = mean(KOT), SD = sd(KOT)), by = .(MidFile)]

# sorted
kot_staccato <- kot_staccato[order(MidFile)]

# plot
kot_staccato$Teaching <- rating[Skill == "articulation"]$Mean_Percent
kot_staccato$TeachingSD <- rating[Skill == "articulation"]$SD_Percent

ggscatter(kot_staccato, x = "Mean", y = "Teaching", add = "reg.line",
          add.params = list(fill = "lightgray"), conf.int = TRUE, cor.coef = TRUE,
          xlab = "KOT (ms)", ylab = "Judged as teaching (%)") + ylim(0, 100)
```

### Model
```{r, echo = FALSE}
model <- lm(Teaching ~ Mean, data = kot_staccato)
check_normality(model)
summary(model)
r2(model)
```

# KV (only dynamics stimuli)
- dynamics and teaching judgement
- linear regression line (black) and 95% confidence interval (gray)

## Forte
```{r vel-forte, echo = FALSE}
dt_vel <- data_onset
# assign Subcomponents
# for each note
dt_vel$Subcomponent <- NA
# Legato
for (phrase in 1:length(ls_legato_2)){
   for (note in 1:length(ls_legato_2[[phrase]])){
     dt_vel$Subcomponent[dt_vel$Skill == "articulation" & dt_vel$Note == ls_legato_2[[phrase]][note]] <- "Legato"
   }
}
# Staccato
for (phrase in 1:length(ls_staccato_2)){
   for (note in 1:length(ls_staccato_2[[phrase]])){
     dt_vel$Subcomponent[dt_vel$Skill == "articulation" & dt_vel$Note == ls_staccato_2[[phrase]][note]] <- "Staccato"
   }
}
# Forte
for (phrase in 1:length(ls_forte_2)){
   for (note in 1:length(ls_forte_2[[phrase]])){
     dt_vel$Subcomponent[dt_vel$Skill == "dynamics" & dt_vel$Note == ls_forte_2[[phrase]][note]] <- "Forte"
   }
}
# Piano
for (phrase in 1:length(ls_piano_2)){
   for (note in 1:length(ls_piano_2[[phrase]])){
     dt_vel$Subcomponent[dt_vel$Skill == "dynamics" & dt_vel$Note == ls_piano_2[[phrase]][note]] <- "Piano"
   }
}


vel_forte <- dt_vel[Subcomponent == "Forte", .(N = .N, Mean = mean(Velocity), SD = sd(Velocity)), by = .(MidFile)]

# sorted
vel_forte <- vel_forte[order(MidFile)]

# plot
vel_forte$Teaching <- rating[Skill == "dynamics"]$Mean_Percent
vel_forte$TeachingSD <- rating[Skill == "dynamics"]$SD_Percent

ggscatter(vel_forte, x = "Mean", y = "Teaching", add = "reg.line",
          add.params = list(fill = "lightgray"), conf.int = TRUE, cor.coef = TRUE,
          xlab = "Velocity (0-127)", ylab = "Judged as teaching (%)") + ylim(0, 100)
```

### Model
```{r, echo = FALSE}
model <- lm(Teaching ~ Mean, data = vel_forte)
check_normality(model)
summary(model)
r2(model)
```

## Piano
```{r vel-piano, echo = FALSE}
vel_piano <- dt_vel[Subcomponent == "Piano", .(N = .N, Mean = mean(Velocity), SD = sd(Velocity)), by = .(MidFile)]

# sorted
vel_piano <- vel_piano[order(MidFile)]

# plot
vel_piano$Teaching <- rating[Skill == "dynamics"]$Mean_Percent
vel_piano$TeachingSD <- rating[Skill == "dynamics"]$SD_Percent

ggscatter(vel_piano, x = "Mean", y = "Teaching", add = "reg.line",
          add.params = list(fill = "lightgray"), conf.int = TRUE, cor.coef = TRUE,
          xlab = "Velocity (0-127)", ylab = "Judged as teaching (%)") + ylim(0, 100)
```

### Model
```{r, echo = FALSE}
model <- lm(Teaching ~ Mean, data = vel_piano)
check_normality(model)
summary(model)
r2(model)
```

# KV-diff (dynamics)
- dynamics changes at transition points (between forte and piano) and teaching judgement
- linear regression line (black) and 95% confidence interval (gray)

## Forte to Piano
```{r vel-diff-forte, echo = FALSE}
data_onset$Diff <- diff(c(0, data_onset$Velocity))
dt_vel_diff <- data_onset[NoteNr != 1]
# assign Interval
dt_vel_diff$Interval <- rep(1:66, nrow(dt_vel_diff)/66)

# for intervals
dt_vel_diff$Subcomponent <- NA
# Legato
for (phrase in 1:length(ls_legato)){
for (note in 1:length(ls_legato[[phrase]])){
  dt_vel_diff$Subcomponent[dt_vel_diff$Skill == "articulation" & dt_vel_diff$Interval == ls_legato[[phrase]][note]] <- "Legato"
}
}
# Staccato
for (phrase in 1:length(ls_staccato)){
for (note in 1:length(ls_staccato[[phrase]])){
  dt_vel_diff$Subcomponent[dt_vel_diff$Skill == "articulation" & dt_vel_diff$Interval == ls_staccato[[phrase]][note]] <- "Staccato"
}
}
# Forte
for (phrase in 1:length(ls_forte)){
for (note in 1:length(ls_forte[[phrase]])){
  dt_vel_diff$Subcomponent[dt_vel_diff$Skill == "dynamics" & dt_vel_diff$Interval == ls_forte[[phrase]][note]] <- "Forte"
}
}
# Piano
for (phrase in 1:length(ls_piano)){
for (note in 1:length(ls_piano[[phrase]])){
  dt_vel_diff$Subcomponent[dt_vel_diff$Skill == "dynamics" & dt_vel_diff$Interval == ls_piano[[phrase]][note]] <- "Piano"
}
}
# Assign Skill Change
for (i in change_1){
dt_vel_diff$Subcomponent[dt_vel_diff$Skill == "articulation" & dt_vel_diff$Interval == i] <- "LtoS"
dt_vel_diff$Subcomponent[dt_vel_diff$Skill == "dynamics" & dt_vel_diff$Interval == i] <- "FtoP"
}
for (i in change_2){
dt_vel_diff$Subcomponent[dt_vel_diff$Skill == "articulation" & dt_vel_diff$Interval == i] <- "StoL"
dt_vel_diff$Subcomponent[dt_vel_diff$Skill == "dynamics" & dt_vel_diff$Interval == i] <- "PtoF"
}

vel_diff_ftop <- dt_vel_diff[Subcomponent == "FtoP", .(N = .N, Mean = mean(Diff), SD = sd(Diff)), by = .(MidFile)]

# sorted
vel_diff_ftop <- vel_diff_ftop[order(MidFile)]

# plot
vel_diff_ftop$Teaching <- rating[Skill == "dynamics"]$Mean_Percent
vel_diff_ftop$TeachingSD <- rating[Skill == "dynamics"]$SD_Percent

ggscatter(vel_diff_ftop, x = "Mean", y = "Teaching", add = "reg.line",
          add.params = list(fill = "lightgray"), conf.int = TRUE, cor.coef = TRUE,
          xlab = "Velocity Difference (-127-127)", ylab = "Judged as teaching (%)") + ylim(0, 100)
```

### Model
```{r, echo = FALSE}
model <- lm(Teaching ~ Mean, data = vel_diff_ftop)
check_normality(model)
summary(model)
r2(model)
```

## Piano to Forte
```{r vel-diff-ptof, echo = FALSE}
vel_diff_ptof <- dt_vel_diff[Subcomponent == "PtoF", .(N = .N, Mean = mean(Diff), SD = sd(Diff)), by = .(MidFile)]

# sorted
vel_diff_ptof <- vel_diff_ptof[order(MidFile)]

# plot
vel_diff_ptof$Teaching <- rating[Skill == "dynamics"]$Mean_Percent
vel_diff_ptof$TeachingSD <- rating[Skill == "dynamics"]$SD_Percent

ggscatter(vel_diff_ptof, x = "Mean", y = "Teaching", add = "reg.line",
          add.params = list(fill = "lightgray"), conf.int = TRUE, cor.coef = TRUE,
          xlab = "Velocity Difference (-127-127)", ylab = "Judged as teaching (%)") + ylim(0, 100)
```

### Model
```{r, echo = FALSE}
model <- lm(Teaching ~ Mean, data = vel_diff_ptof)
check_normality(model)
summary(model)
r2(model)
```
